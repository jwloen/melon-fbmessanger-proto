<!DOCTYPE html>
<html>
  <head>
    <title>Shopping List</title>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <script src="/bundle.js"></script>
  </head>
 <body>
  <div class="container">
        <ul>
          <% tracks.forEach(function(tracks) { %>
            <a onClick = "onClick()">
              <li><%= tracks.artist %> - <%= tracks.title %>
                <img src ="<%= tracks.imgurl %>"></img>
              </li>
          <% }); %>
        </ul>
        
  </div>
	<script>

  function onClick(){
    var messageToShare = {
      "attachment":{
         "type":"template",
         "payload":{
             "template_type":"generic",
             "elements": [{
                 "title":"LIKELY - TWICE (트와이스)",
                 "image_url": "http://cdnimg.melon.co.kr/cm/album/images/101/07/114/10107114_500.jpg/melon/resize/216/quality/80/optimize",
                 "default_action":{
                     "type":"web_url",
                     "url": "https://melon.do/mZjoCNggH"
                 },
                 "buttons":[{
                     "type":"web_url",
                     "url":"https://m.app.melon.com",
                     "title":"음악을 즐기다 MelOn"
                 }]
             }]
         }
      }
    };

    window.extAsyncInit = function() { 
    MessengerExtensions.beginShareFlow(function success(response) {
  	// User dismissed without error, but did they
        // share the message?
      
      	if(response.is_sent){
          MessengerExtensions.requestCloseBrowser();
      	  	// The user actually did share. 
      		// Perhaps close the window w/ requestCloseBrowser().
      	}else{
      			
      	}
  
    }, function error(errorCode, errorMessage) {      
  	// An error occurred in the process
      
    },
    messageToShare,
    "current_thread");    

    };
  }
  

	
      
 	(function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.com/en_US/messenger.Extensions.js";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'Messenger'));
    </script>
  </body>
</html>




