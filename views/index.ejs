<!DOCTYPE html>
<html>
  <head>
    <title>Shopping List</title>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <script src="/bundle.js"></script>
  </head>
  <header>
		<% include partial/header %>
	</header>
 <body>
	<div id="content"></div>
	
  
	<script>
  var messageToShare = {
      "attachment":{
         "type":"template",
         "payload":{
             "template_type":"generic",
             "elements": [{
                 "title":"I took Peter's 'Which Hat Are You?' Quiz",
                 "image_url": "https://bot.peters-hats.com/img/hats/fez.jpg",
                 "subtitle": "My result: Fez",
                 "default_action":{
                     "type":"web_url",
                     "url": "https://bot.peters-hats.com/view_quiz_results.php?user=24601"
                 },
                 "buttons":[{
                     "type":"web_url",
                     "url":"https://bot.peters-hats.com/hatquiz.php?referer=24601",
                     "title":"Take the Quiz"
                 }]
             }]
         }
      }
    };


	window.extAsyncInit = function() {
        // MessengerExtensions.getContext(
        //   '282911732206558',
        //   function success(context) {
        //     window.attachApp(
        //       context.psid,
        //       1,
        //       11,
        //       context.thread_type);
        //   }, function error(err) {
        //     window.attachApp();
        //   });
      
    MessengerExtensions.beginShareFlow(function success(response) {
  	// User dismissed without error, but did they
        // share the message?
      
      	if(response.is_sent){
          MessengerExtensions.requestCloseBrowser();
      	  	// The user actually did share. 
      		// Perhaps close the window w/ requestCloseBrowser().
      	}else{
      			
      	}
  
    }, function error(errorCode, errorMessage) {      
  	// An error occurred in the process
      
    },
    messageToShare,
    "current_thread");    

      };
      
 	(function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.com/en_US/messenger.Extensions.js";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'Messenger'));
    </script>
  </body>
</html>


